<html>
    <head>
        <title>幻卡扭域</title>
        <style>
            * {
                box-sizing: border-box;
                margin: 0;
                padding: 0;
            }

            body {
                font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
                background: radial-gradient(circle at top, #272953 0, #090919 50%, #050510 100%);
                color: #f5f5ff;
                height: 100vh;
                overflow: hidden;
                position: relative;
            }

            /* 中央怪物 + 主角區 */
            .battle {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -55%);
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 16px;
            }

            .monster,
            .player {
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .monster img {
                width: 200px;
                height: 200px;
                object-fit: contain;
            }

            .player img {
                width: 140px;
                height: 140px;
                object-fit: contain;
            }

            /* 右上角選單容器 */
            .container {
                position: fixed;
                top: 10px;
                right: 10px;
                display: flex;
                flex-direction: column;
                gap: 10px;
                align-items: center;
            }

            .menu-item {
                display: flex;
                flex-direction: column;
                align-items: center;
                background: rgba(12, 12, 40, 0.86);
                border-radius: 14px;
                padding: 6px 6px 8px;
                border: 1px solid rgba(255, 255, 255, 0.14);
                box-shadow: 0 0 12px rgba(0, 0, 0, 0.5);
            }

            .img {
                width: 60px;
                height: 60px;
                object-fit: contain;
                margin-bottom: 4px;
            }

            .button {
                border: none;
                padding: 4px 10px;
                border-radius: 999px;
                cursor: pointer;
                font-size: 0.8rem;
                background: rgba(40, 40, 90, 0.9);
                color: #f5f5ff;
                letter-spacing: 0.1em;
            }

            .button:hover {
                background: rgba(80, 80, 150, 0.95);
            }

            /* 左上角金幣顯示（可調位置） */
            .coin-panel {
                position: fixed;
                left: 10px;
                top: 10px;
                padding: 6px 10px;
                border-radius: 999px;
                background: rgba(10, 10, 30, 0.8);
                border: 1px solid rgba(255, 255, 255, 0.12);
                font-size: 0.9rem;
                display: flex;
                align-items: center;
                gap: 6px;
            }

            /* 左下角貓咪 + 面板 */
            .wrap {
                position: fixed;
                left: 10px;
                bottom: 10px;
                display: flex;
                align-items: center;
                gap: 10px;
                background: rgba(10, 10, 30, 0.8);
                border-radius: 0 12px 12px 0;
                padding: 8px 12px 8px 0;
                border: 1px solid rgba(255, 255, 255, 0.15);
            }

            #cat {
                width: 80px;
                height: 80px;
                object-fit: cover;
                border-radius: 999px;
                cursor: pointer;
                box-shadow: 0 0 18px rgba(0, 0, 0, 0.8);
            }

            #cat:hover {
                transform: translateY(-2px);
                box-shadow: 0 0 24px rgba(255, 255, 255, 0.25);
            }

            .panel {
                font-size: 0.85rem;
                color: #e0e1ff;
            }

            .panel div + div {
                margin-top: 4px;
            }

            /* +10 飄字效果 */
            .coin-float {
                position: fixed;
                font-size: 0.9rem;
                font-weight: 700;
                color: #ffd84a;
                text-shadow: 0 0 12px rgba(255, 216, 74, 0.9);
                pointer-events: none;
                animation: floatUp 0.7s ease-out forwards;
            }

            @keyframes floatUp {
                0% {
                    opacity: 1;
                    transform: translateY(0);
                }
                100% {
                    opacity: 0;
                    transform: translateY(-30px);
                }
            }
            /* --- 新增：角色卡片樣式 (從 Inventory 搬過來的) --- */
            .char-card {
                width: 140px; /* 配合原本主角的大小 */
                background: rgba(20, 20, 45, 0.9);
                border: 2px solid #4a4a70;
                border-radius: 12px;
                overflow: hidden;
                display: flex;
                flex-direction: column;
                box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            }

            .card-img {
                width: 100%;
                aspect-ratio: 1/1;
                object-fit: cover;
                background: rgba(0,0,0,0.2);
                border-bottom: 1px solid rgba(255,255,255,0.1);
            }

            .card-info {
                padding: 6px; /* 稍微縮小一點 padding 以適應主畫面 */
                text-align: center;
            }

            .card-name {
                font-size: 0.9rem;
                font-weight: bold;
                margin-bottom: 4px;
                color: #fff;
                white-space: nowrap; /* 避免名字換行 */
                overflow: hidden;
                text-overflow: ellipsis;
            }

            .card-power {
                font-size: 0.8rem;
                color: #00e676;
            }
        </style>
    </head>
    <body>
        <!-- 金幣顯示 -->
        <div class="coin-panel">
            金幣：<span id="coins">0</span>
        </div>

        <!-- 中央怪獸 + 主角 -->
        <div class="battle">
            <div class="monster"><!--怪獸-->
                <!-- 換成你的怪獸圖片路徑 -->
                <img src="monster.png" alt="怪物">
            </div>
            <div class="player"><!--主角-->
                <!-- 換成你的主角圖片路徑 -->
                <img src="player.png" alt="主角">
            </div>
        </div>

        <!-- 右上角選單 -->
        <div class="container">
            <div class="menu-item">
                <img class="img" src="https://png.pngtree.com/png-vector/20201224/ourmid/pngtree-ancient-battlefield-armor-helmet-vector-png-image_2591845.jpg" alt="外觀">
                
                <button class="button" onclick="window.location.href='./inventory.html'">角色</button>
            </div>
            
            <div class="menu-item">
                <img class="img" src="https://png.pngtree.com/png-clipart/20211229/ourmid/pngtree-hand-drawn-blue-large-egg-twisting-machine-illustration-png-image_4070974.png" alt="抽卡">
                <button class="button" type="button" onclick="window.location.href='./gacha.html'">抽卡</button>
            </div>

            <div class="menu-item">
                <img class="img" src="https://png.pngtree.com/element_our/png/20181227/settings-glyph-black-icon-png_292947.jpg" alt="設定">
                <button class="button">設定</button>
            </div>
        </div>

        <!-- 左下角貓咪 + 點擊資訊 -->
        <div class="wrap">
            <!-- 換成你的貓咪圖片：cat1.jpg / cat2.jpg -->
            <img id="cat" src="https://popcat.click/twitter-card.jpg" alt="cat">
            <div class="panel">
                <div>點擊次數：<span id="clickCount">0</span></div>
                <div>金幣：<span id="coinsPanel">0</span></div>
                <div style="font-size:0.8rem;color:#bfc1ff;">點貓：喵一聲 +10 金幣</div>
            </div>
        </div>

        <!-- 貓叫聲音效 -->
        <audio id="meow" src="meow.mp3" preload="auto"></audio>

        <script>
            // --- 新增：讀取出戰角色 ---
            window.addEventListener('DOMContentLoaded', () => {
                const playerContainer = document.querySelector('.player');
                
                // 1. 從 LocalStorage 讀取資料
                const savedData = localStorage.getItem('selectedHero');

                // 2. 如果有資料，就取代原本的圖片
                if (savedData) {
                    const char = JSON.parse(savedData);

                    // 替換 HTML 結構，使用跟角色庫一樣的卡片樣式
                    playerContainer.innerHTML = `
                        <div class="char-card">
                            <img src="${char.img}" alt="${char.name}" class="card-img">
                            <div class="card-info">
                                <div class="card-name">${char.name}</div>
                                <div class="card-power">⚔️ ${char.combatPower}</div>
                            </div>
                        </div>
                    `;
                }
            });

            const img = document.getElementById("cat");
            const audio = document.getElementById("meow");
            const clickCountEl = document.getElementById("clickCount");
            const coinsPanelEl = document.getElementById("coinsPanel");
            const coinsTopEl = document.getElementById("coins");

            const img1 = "https://popcat.click/twitter-card.jpg";
            const img2 = "https://i.redd.it/8btmhq88z5s71.jpg";
            let toggled = false;

            let clicks = 0;
            let coins = 0;

            img.onclick = (event) => 
            {
                // 貓叫一次：每次點都從頭播
                audio.currentTime = 0;
                audio.play();

                // 換圖（來回切）
                toggled = !toggled;
                img.src = toggled ? img2 : img1;

                // 記錄點擊次數與金幣
                clicks += 1;
                coins += 10;

                // 更新顯示（左下 panel + 左上總金幣）
                clickCountEl.textContent = clicks;
                coinsPanelEl.textContent = coins;
                coinsTopEl.textContent = coins;

                // 產生 +10 飄字
                createCoinFloat(event.clientX, event.clientY);
            };

            function createCoinFloat(clientX, clientY) {
                const floatEl = document.createElement("div");
                floatEl.className = "coin-float";
                floatEl.textContent = "+10";

                floatEl.style.left = clientX + "px";
                floatEl.style.top = clientY + "px";

                document.body.appendChild(floatEl);

                setTimeout(() => {
                    floatEl.remove();
                }, 700);
            }
        </script>
    </body>
</html>
